!function(c){var t={};function n(e){if(t[e])return t[e].exports;var r=t[e]={i:e,l:!1,exports:{}};return c[e].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=c,n.c=t,n.d=function(c,t,e){n.o(c,t)||Object.defineProperty(c,t,{enumerable:!0,get:e})},n.r=function(c){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(c,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(c,"__esModule",{value:!0})},n.t=function(c,t){if(1&t&&(c=n(c)),8&t)return c;if(4&t&&"object"==typeof c&&c&&c.__esModule)return c;var e=Object.create(null);if(n.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:c}),2&t&&"string"!=typeof c)for(var r in c)n.d(e,r,function(t){return c[t]}.bind(null,r));return e},n.n=function(c){var t=c&&c.__esModule?function(){return c.default}:function(){return c};return n.d(t,"a",t),t},n.o=function(c,t){return Object.prototype.hasOwnProperty.call(c,t)},n.p="",n(n.s=0)}([function(module,exports,__webpack_require__){"use strict";eval("\r\n\r\n// service worker registration - remove if you're not going to use it\r\n\r\nif (\"serviceWorker\" in navigator) {\r\n  window.addEventListener(\"load\", function () {\r\n    navigator.serviceWorker.register(\"serviceworker.js\").then(\r\n      function (registration) {\r\n        // Registration was successful\r\n        console.log(\r\n          \"ServiceWorker registration successful with scope: \",\r\n          registration.scope\r\n        );\r\n      },\r\n      function (err) {\r\n        // registration failed :(\r\n        console.log(\"ServiceWorker registration failed: \", err);\r\n      }\r\n    );\r\n  });\r\n}\r\n\r\n// place your code below\r\nconst apiKey = \"53c5e97675c8d3d8da07e56aec5a3a22\";\r\nconst axisXposition = 280; // X axis is on 280px Canvas Height;\r\n\r\n(function () {\r\n  var lastTime = 0;\r\n  var vendors = ['ms', 'moz', 'webkit', 'o'];\r\n  for (var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\r\n      window.requestAnimationFrame = window[vendors[x] + 'RequestAnimationFrame'];\r\n      window.cancelAnimationFrame = window[vendors[x] + 'CancelAnimationFrame'] || window[vendors[x] + 'CancelRequestAnimationFrame'];\r\n  }\r\n\r\n  if (!window.requestAnimationFrame) window.requestAnimationFrame = function (callback, element) {\r\n      var currTime = new Date().getTime();\r\n      var timeToCall = Math.max(0, 16 - (currTime - lastTime));\r\n      var id = window.setTimeout(function () {\r\n          callback(currTime + timeToCall);\r\n      },\r\n      timeToCall);\r\n      lastTime = currTime + timeToCall;\r\n      return id;\r\n  };\r\n\r\n  if (!window.cancelAnimationFrame) window.cancelAnimationFrame = function (id) {\r\n      clearTimeout(id);\r\n  };\r\n}());\r\n\r\n\r\n\r\nfunction success(loc) {\r\n  const { coords } = loc;\r\n}\r\n\r\nfunction error(err) {\r\n  console.warn(`ERROR(${err.code}): ${err.message}`);\r\n}\r\n\r\nconst options = {\r\n  enableHighAccuracy: true,\r\n  timeout: 5000,\r\n  maximumAge: 0,\r\n};\r\n\r\nfunction consolValue(val) {\r\n  return val;\r\n}\r\n\r\nfunction location() {\r\n  return new Promise((resolve, reject) =>\r\n    navigator.geolocation.getCurrentPosition(resolve, error)\r\n  );\r\n}\r\n\r\nasync function getLocation() {\r\n  let position = await location();\r\n  position = await position.coords;\r\n  const { latitude, longitude } = position;\r\n\r\n  let weatherByPosition = await fetch(\r\n    `https://api.openweathermap.org/data/2.5/weather?lat=${latitude}&lon=${longitude}&appid=${apiKey}&units=metric&lang=pl`\r\n  );\r\n  \r\n  \r\n  let weatherByHour = await fetch(`https://api.openweathermap.org/data/2.5/onecall?lat=${latitude}&lon=${longitude}&\r\n  exclude=hourly&appid=${apiKey}&units=metric`);\r\n  weatherByPosition = await weatherByPosition.json();\r\n\r\n  weatherByHour = await weatherByHour.json();\r\n  weatherByHour = weatherByHour.hourly;\r\n\r\n  let nextSevenDays = await fetch(`https://api.openweathermap.org/data/2.5/onecall?lat=${latitude}&lon=${longitude}&\r\n  exclude=daily&appid=${apiKey}&units=metric`)\r\n  nextSevenDays = await nextSevenDays.json();\r\n  nextSevenDays = nextSevenDays.daily;\r\n  console.log(weatherByPosition)\r\n  const weatherData = new WeatherInformation(weatherByPosition);\r\n  weatherData.setWeatherInformation();\r\n  const chart = new Chart(weatherByHour);\r\n  chart.chart();\r\n  const forecastForWeek = new WeekForecast(nextSevenDays);\r\n  forecastForWeek.addWeatherForecast();\r\n  \r\n}\r\n\r\n\r\n\r\n\r\n\r\nclass WeatherInformation {\r\n  constructor(weatherInfo) {\r\n    this.location = weatherInfo.name,\r\n    this.country = weatherInfo.sys.country\r\n    this.date = new Date(),\r\n    this.temp = weatherInfo.main.temp,\r\n    this.iconName = weatherInfo.weather[0].main,\r\n    this.pressure = weatherInfo.main.pressure,\r\n    this.humidity = weatherInfo.main.humidity,\r\n    this.windSpped = weatherInfo.wind.speed\r\n  }\r\n\r\n  setLocation() {\r\n    const locationID = document.getElementsByClassName(\"headText__location--js\")[0];\r\n    locationID.innerHTML = `in ${this.location}, ${this.country}`;\r\n  }\r\n  setDate() {\r\n    const dateID = document.getElementsByClassName(\"headText__date--js\")[0];\r\n    dateID.innerHTML = `Today ${this.date.getDate()}th, ${this.date.toLocaleString('en-EN', {month: 'long'})}`\r\n  }\r\n  \r\n  setTemp() {\r\n    const tempID = document.getElementsByClassName(\"headText--degrees-js\")[0];\r\n    tempID.innerHTML = `${this.temp.toFixed(1)} °C`;\r\n  }\r\n\r\n  setPressure() {\r\n    const pressureID = document.getElementsByClassName(\"weatherToday__pressure--js\")[0];\r\n    pressureID.innerHTML = `${this.pressure} hPa`;\r\n  }\r\n\r\n  setHumidity() {\r\n    const humidityID = document.getElementsByClassName(\"weatherToday__humidity--js\")[0];\r\n    humidityID.innerHTML = `${this.humidity} %`;\r\n  }\r\n\r\n  setWindSpeed() {\r\n    const windSpeedID = document.getElementsByClassName(\"weatherToday__windSpeed--js\")[0];\r\n    windSpeedID.innerHTML = `${this.windSpped} m/s`;\r\n  }\r\n\r\n  setWeatherInformation() {\r\n    this.setLocation();\r\n    this.setDate();\r\n    this.setTemp();\r\n    this.setPressure();\r\n    this.setHumidity();\r\n    this.setWindSpeed();\r\n  }\r\n\r\n  weatherIcon(weather) {\r\n    let currentDate = new Date();\r\n    currentDate = currentDate.getHours();\r\n    switch(weather) {\r\n      case 'thunderstorm':\r\n        return 'storm.svg';\r\n        break;\r\n      case 'Drizzle':\r\n        return 'Drizzle.svg';\r\n        break;\r\n      case 'Rain':\r\n        return 'Rain.svg';\r\n        break;\r\n      case 'Snow':\r\n        return 'Snowflake.svg';\r\n        break;\r\n      case 'Atmosphere':\r\n        return 'fog.svg';\r\n        break;\r\n      case 'Clear':\r\n        if(currentDate <= 20) {\r\n          return 'sun.svg';\r\n          break;\r\n        }\r\n        else {\r\n          return 'moon.svg';\r\n          break;\r\n        }\r\n      case 'Clouds':\r\n        return 'Clouds.svg'\r\n        break;\r\n    }\r\n  }\r\n\r\n  setImage() {\r\n    const imageID = document.getElementsByClassName(\"weatherImage--js\")[0];\r\n    const weatherName = this.weatherIcon(this.iconName);\r\n    imageID.src = `assets/img/${weatherName}`;\r\n  }\r\n  roundTemp(temp) {\r\n    return Math.round((temp * 100)/100);\r\n  }\r\n}\r\nclass Chart {\r\n  constructor(weatherData) {\r\n    this.weatherByHour = weatherData;\r\n    this.condition = false;\r\n    this.state = {};\r\n    this.tooltip = document.getElementsByClassName(\"chartTemp__tooltip\")[0];\r\n    this.canvas = document.getElementById(\"chartTemp__canvas\");\r\n    this.ctx = this.canvas.getContext(\"2d\");\r\n  }\r\n\r\n  canvasDimensions() {\r\n    this.canvas.width = 660;\r\n    this.canvas.height = 309;\r\n  }\r\n\r\n  blocks(count) {\r\n    return count * 40;\r\n  }\r\n\r\n  drawGrid() {\r\n    let gridX = 40;\r\n    let gridY = 40;\r\n    const cellSize = 40;\r\n    this.ctx.beginPath();\r\n    this.ctx.strokeStyle = \"lightgrey\";\r\n  \r\n    while (gridX <= this.canvas.width - 20) {\r\n      this.ctx.moveTo(gridX, 20);\r\n      this.ctx.lineTo(gridX, this.canvas.height - 20);\r\n      gridX += cellSize;\r\n    }\r\n    while (gridY <= this.canvas.height - 20) {\r\n      this.ctx.moveTo(20, gridY);\r\n      this.ctx.lineTo(this.canvas.width - 10, gridY);\r\n      gridY += cellSize;\r\n    }\r\n    this.ctx.stroke();\r\n  }\r\n\r\n  async drawAxis(hours) {\r\n    this.ctx.beginPath();\r\n    this.ctx.strokeStyle = \"black\";\r\n    this.ctx.moveTo(this.blocks(1), this.blocks(1 / 2));\r\n    this.ctx.lineTo(this.blocks(1), this.blocks(7));\r\n    this.ctx.lineTo(this.blocks(16), this.blocks(7));\r\n  \r\n    this.ctx.moveTo(this.blocks(1), this.blocks(7));\r\n    let text = 0;\r\n    let textY = this.blocks(7);\r\n    for (let i = 1; i <= 7; i++) {\r\n      this.ctx.strokeText(text, this.blocks(1 / 2), textY);\r\n      textY -= 40;\r\n      text += 5;\r\n    }\r\n  \r\n    this.ctx.moveTo(this.blocks(2), this.blocks(7));\r\n    let textX = this.blocks(1.9);\r\n  \r\n    for (let i = 0; i <= 15; i++) {\r\n      this.ctx.strokeText(hours[i], textX, this.blocks(7.5));\r\n      textX += 40;\r\n    }\r\n    this.ctx.stroke();\r\n  }\r\n  timestampToTime(stamp) {\r\n    let date = new Date(stamp * 1000);\r\n    return date.getHours();\r\n  }\r\n  \r\n  mapAndFilter(tempArray) {\r\n    tempArray = tempArray.map((el) => this.timestampToTime(el));\r\n    tempArray = tempArray.filter((el) => el % 2 == 0);\r\n    return tempArray;\r\n  }\r\n  \r\n  temperatureToChartCoords(temp){\r\n    let temperature = temp.map((el) => el / 5);\r\n    temperature = temperature.slice(0,15);\r\n    return temperature;\r\n  }\r\n  \r\n  getHoursCoords() {\r\n    let hourOfTemp = [...Array(17).keys()]\r\n    hourOfTemp = hourOfTemp.slice(2, 17);\r\n  \r\n    return hourOfTemp;\r\n  }\r\n  \r\n  drawChart(temperature) {\r\n    const tempHours = this.getHoursCoords();\r\n    let i = 1;\r\n    const context = this.ctx\r\n    const block = this.blocks.bind(this);\r\n    function animation() {\r\n      if (i <= temperature.length) {\r\n        window.requestAnimationFrame(animation);\r\n      }\r\n      context.strokeStyle = \"#FFE74A\";\r\n      context.lineWidth = 3;\r\n      context.beginPath();\r\n      context.moveTo(block(tempHours[i-1]), axisXposition - block(temperature[i-1]));\r\n      context.arc(block(tempHours[i-1]), axisXposition - block(temperature[i-1]), 3, 0, Math.PI * 2, true);\r\n      context.lineTo(block(tempHours[i]), axisXposition - block(temperature[i]));\r\n      context.stroke();\r\n      i++;\r\n    }\r\n    animation();\r\n  }\r\n  \r\n  async waitForGrid(ms) {\r\n    return new Promise(r => setTimeout(r, ms));\r\n  }\r\n  \r\n  getMousePosition(evt) {\r\n    let rect = this.canvas.getBoundingClientRect();\r\n    return {\r\n      x: evt.clientX - rect.left,\r\n      y: evt.clientY - rect.top\r\n    };\r\n  }\r\n  \r\n  filterTemperature(temperature) {\r\n    const temp = temperature\r\n      .map((obj) => obj.temp)\r\n      .filter((el, index) => index % 2 == 0);\r\n  \r\n    return temp;\r\n  }\r\n  \r\n  temperatureToPixel(temp){\r\n    temp = temp.map(el => axisXposition - this.blocks(el));\r\n    return temp;\r\n  }\r\n  \r\n  hoursToPixel(hours) {\r\n    const hourrs = hours.map(el => this.blocks(el));\r\n    return hourrs;\r\n  }\r\n  \r\n  createTempObj(hour, temp, hourOfTemp, tempInHour){\r\n    const tempPointCoords = [];\r\n    for (let i = 0; i < temp.length; i++){\r\n      tempPointCoords.push({\r\n        x: hour[i],\r\n        y: temp[i],\r\n        xmin: hour[i] - 3,\r\n        xmax: hour[i] + 3,\r\n        ymin: temp[i] - 3,\r\n        ymax: temp[i] + 3,\r\n        hourTemp: {\r\n          hour: hourOfTemp[i],\r\n          temp: tempInHour[i]\r\n        },\r\n  \r\n      })\r\n    }\r\n    return tempPointCoords;\r\n  }\r\n  \r\n  drawPoint(coords = {}, radius, color = 'white') {\r\n    const mouseCoordinate = coords;\r\n    this.ctx.strokeStyle = color;\r\n    this.ctx.beginPath();\r\n    this.ctx.moveTo(mouseCoordinate.x, mouseCoordinate.y);\r\n    this.ctx.arc(mouseCoordinate.x, mouseCoordinate.y, radius, 0, Math.PI * 2, true);\r\n    this.ctx.fillStyle = color;\r\n    this.ctx.fill();\r\n    this.ctx.stroke();\r\n  }\r\n  \r\n\r\n  addPopUp(tempPoint) {\r\n    this.canvas.addEventListener('mousemove', (e) => {\r\n      const mouseCoords = this.getMousePosition(e);\r\n      let boools = tempPoint.filter(el => {\r\n        const a = el.xmin <= mouseCoords.x;\r\n        const b = mouseCoords.x <= el.xmax;\r\n        const c = el.ymin <= mouseCoords.y;\r\n        const d = mouseCoords.y <= el.ymax;\r\n        return (a && b && c && d)})\r\n      \r\n      if(boools.length) {\r\n        this.drawPoint(boools[0], 1);\r\n        this.state = {...boools[0]};\r\n        this.condition = true;\r\n        if (this.canvas.width - (this.state.x + 5) <= 80){\r\n          this.tooltip.style.left = `${this.state.x - 85}px`\r\n          this.tooltip.style.top = `${this.state.y - 35}px`;\r\n          \r\n        }\r\n        else {\r\n          this.tooltip.style.left = `${this.state.x + 5}px`;\r\n          this.tooltip.style.top = `${this.state.y - 35}px`;\r\n        }\r\n        this.tooltip.style.display = 'flex';\r\n        this.tooltip.innerHTML = `Time: ${this.state.hourTemp.hour}:00, Temp: ${this.state.hourTemp.temp}°C`;\r\n      } \r\n      else if(!boools.length) {\r\n        this.drawPoint(this.state, 3, \"#FFE74A\");\r\n        this.condition = false;\r\n        this.state = {};\r\n        this.tooltip.style.display = 'none';\r\n      } \r\n    })\r\n  }\r\n  \r\n  async chart() {\r\n    const hourOfWeather = this.mapAndFilter(this.weatherByHour.map((obj) => obj.dt));\r\n    let temperature = this.filterTemperature(this.weatherByHour);\r\n    const temperatureCoords = this.temperatureToChartCoords(temperature);\r\n    \r\n    const tempPixels = this.temperatureToPixel(temperatureCoords);\r\n    const hoursPixels = this.hoursToPixel(this.getHoursCoords());\r\n    \r\n    const tempPoints = this.createTempObj(hoursPixels, tempPixels, hourOfWeather, temperature);\r\n  \r\n    this.canvasDimensions();\r\n    this.drawGrid();\r\n    this.drawAxis(hourOfWeather);\r\n    await this.waitForGrid(500);\r\n    this.drawChart(temperatureCoords)\r\n    this.addPopUp(tempPoints);\r\n  }\r\n\r\n}\r\n\r\nclass WeekForecast {\r\n  constructor(weekForecastData) {\r\n    this.weekData = weekForecastData;\r\n    this.weatherForecastContainer = document.getElementsByClassName(\"weatherForecast--js\");\r\n    this.weatherForecastContainer = this.weatherForecastContainer[0];\r\n  }\r\n\r\n  sliceWeekDataArray(){\r\n    this.weekData = this.weekData.slice(1,8);\r\n    console.log(this.weekData)\r\n  }\r\n  getTimestampToTime(timestamp) {\r\n    const time = new Date(timestamp * 1000);\r\n    return time.getDay();\r\n  }\r\n  getNameOfWeek(number) {\r\n    switch (number) {\r\n      case 0:\r\n        return \"Sun\";\r\n        break;\r\n      case 1:\r\n        return \"Mon\";\r\n        break;\r\n      case 2:\r\n        return \"Tue\";\r\n        break;\r\n      case 3:\r\n        return \"Wed\";\r\n        break;\r\n      case 4:\r\n        return \"Thur\";\r\n        break;\r\n      case 5: \r\n        return \"Fri\";\r\n        break;\r\n      case 6:\r\n        return \"Sat\";\r\n        break\r\n    }\r\n  }\r\n  getWeatherParameters(){\r\n    this.weekData = this.weekData.map(el => {\r\n      return {\r\n        day: this.getNameOfWeek(this.getTimestampToTime(el.dt)), \r\n        temp: el.temp.day,\r\n        weather: el.weather[0].main\r\n      }\r\n    });\r\n    console.log(this.weekData)\r\n  }\r\n\r\n  putWeatherIntoSection(){\r\n    this.weatherForecastContainer.innerHTML = '';\r\n    this.weekData.forEach(el => {\r\n      this.weatherForecastContainer.innerHTML += `<div class=\"weatherForecast__day weatherForecast__day--js\"><img class=\"weatherForecast__dayElement\" src='/assets/img/weathericons/${this.weatherIcon(el.weather)}' alt=''></img><div class=\"weatherForecast__dayElement\"><p>${el.day}<br>${el.temp}</p></div></div>`\r\n    })\r\n  }\r\n\r\n  addWeatherForecast() {\r\n    this.sliceWeekDataArray();\r\n    this.getWeatherParameters();\r\n    this.putWeatherIntoSection();\r\n  }\r\n\r\n  weatherIcon(weather) {\r\n    let currentDate = new Date();\r\n    currentDate = currentDate.getHours();\r\n    switch(weather) {\r\n      case 'thunderstorm':\r\n        return 'storm.svg';\r\n        break;\r\n      case 'Drizzle':\r\n        return 'Drizzle.svg';\r\n        break;\r\n      case 'Rain':\r\n        return 'Rain.svg';\r\n        break;\r\n      case 'Snow':\r\n        return 'Snowflake.svg';\r\n        break;\r\n      case 'Atmosphere':\r\n        return 'fog.svg';\r\n        break;\r\n      case 'Clear':\r\n        if(currentDate <= 20) {\r\n          return 'sun.svg';\r\n          break;\r\n        }\r\n        else {\r\n          return 'moon.svg';\r\n          break;\r\n        }\r\n      case 'Clouds':\r\n        return 'Clouds.svg'\r\n        break;\r\n    }\r\n  }\r\n\r\n}\r\n\r\n\r\n\r\ngetLocation();//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvanMvbWFpbi5qcz85MjkxIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFhOztBQUViOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQSwwQkFBMEI7O0FBRTFCO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixxREFBcUQ7QUFDdEU7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsQ0FBQzs7OztBQUlEO0FBQ0EsU0FBUyxTQUFTO0FBQ2xCOztBQUVBO0FBQ0Esd0JBQXdCLFNBQVMsS0FBSyxZQUFZO0FBQ2xEOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsU0FBUyxzQkFBc0I7O0FBRS9CO0FBQ0EsMkRBQTJELFNBQVMsT0FBTyxVQUFVLFNBQVMsT0FBTztBQUNyRzs7O0FBR0EseUZBQXlGLFNBQVMsT0FBTyxVQUFVO0FBQ25ILHlCQUF5QixPQUFPO0FBQ2hDOztBQUVBO0FBQ0E7O0FBRUEseUZBQXlGLFNBQVMsT0FBTyxVQUFVO0FBQ25ILHdCQUF3QixPQUFPO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7Ozs7O0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsaUNBQWlDLGNBQWMsSUFBSSxhQUFhO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQyxvQkFBb0IsTUFBTSxtQ0FBbUMsY0FBYyxFQUFFO0FBQzdHOztBQUVBO0FBQ0E7QUFDQSwwQkFBMEIscUJBQXFCO0FBQy9DOztBQUVBO0FBQ0E7QUFDQSw4QkFBOEIsY0FBYztBQUM1Qzs7QUFFQTtBQUNBO0FBQ0EsOEJBQThCLGNBQWM7QUFDNUM7O0FBRUE7QUFDQTtBQUNBLCtCQUErQixlQUFlO0FBQzlDOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQyxZQUFZO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQixRQUFRO0FBQzNCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUEsbUJBQW1CLFNBQVM7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxtQkFBbUIsaUJBQWlCO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVCxPQUFPO0FBQ1A7QUFDQTtBQUNBOztBQUVBLHVCQUF1QjtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0M7O0FBRWxDO0FBQ0E7QUFDQSxzQkFBc0I7QUFDdEI7QUFDQTtBQUNBLHVDQUF1QyxrQkFBa0I7QUFDekQsc0NBQXNDLGtCQUFrQjs7QUFFeEQ7QUFDQTtBQUNBLHVDQUF1QyxpQkFBaUI7QUFDeEQsc0NBQXNDLGtCQUFrQjtBQUN4RDtBQUNBO0FBQ0EsMENBQTBDLHlCQUF5QixhQUFhLHlCQUF5QjtBQUN6RyxPO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE87QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxzTEFBc0wsNkJBQTZCLDZEQUE2RCxPQUFPLE1BQU0sUUFBUTtBQUNyUyxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7Ozs7QUFJQSIsImZpbGUiOiIwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4vLyBzZXJ2aWNlIHdvcmtlciByZWdpc3RyYXRpb24gLSByZW1vdmUgaWYgeW91J3JlIG5vdCBnb2luZyB0byB1c2UgaXRcclxuXHJcbmlmIChcInNlcnZpY2VXb3JrZXJcIiBpbiBuYXZpZ2F0b3IpIHtcclxuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgbmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIucmVnaXN0ZXIoXCJzZXJ2aWNld29ya2VyLmpzXCIpLnRoZW4oXHJcbiAgICAgIGZ1bmN0aW9uIChyZWdpc3RyYXRpb24pIHtcclxuICAgICAgICAvLyBSZWdpc3RyYXRpb24gd2FzIHN1Y2Nlc3NmdWxcclxuICAgICAgICBjb25zb2xlLmxvZyhcclxuICAgICAgICAgIFwiU2VydmljZVdvcmtlciByZWdpc3RyYXRpb24gc3VjY2Vzc2Z1bCB3aXRoIHNjb3BlOiBcIixcclxuICAgICAgICAgIHJlZ2lzdHJhdGlvbi5zY29wZVxyXG4gICAgICAgICk7XHJcbiAgICAgIH0sXHJcbiAgICAgIGZ1bmN0aW9uIChlcnIpIHtcclxuICAgICAgICAvLyByZWdpc3RyYXRpb24gZmFpbGVkIDooXHJcbiAgICAgICAgY29uc29sZS5sb2coXCJTZXJ2aWNlV29ya2VyIHJlZ2lzdHJhdGlvbiBmYWlsZWQ6IFwiLCBlcnIpO1xyXG4gICAgICB9XHJcbiAgICApO1xyXG4gIH0pO1xyXG59XHJcblxyXG4vLyBwbGFjZSB5b3VyIGNvZGUgYmVsb3dcclxuY29uc3QgYXBpS2V5ID0gXCI1M2M1ZTk3Njc1YzhkM2Q4ZGEwN2U1NmFlYzVhM2EyMlwiO1xyXG5jb25zdCBheGlzWHBvc2l0aW9uID0gMjgwOyAvLyBYIGF4aXMgaXMgb24gMjgwcHggQ2FudmFzIEhlaWdodDtcclxuXHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgdmFyIGxhc3RUaW1lID0gMDtcclxuICB2YXIgdmVuZG9ycyA9IFsnbXMnLCAnbW96JywgJ3dlYmtpdCcsICdvJ107XHJcbiAgZm9yICh2YXIgeCA9IDA7IHggPCB2ZW5kb3JzLmxlbmd0aCAmJiAhd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZTsgKyt4KSB7XHJcbiAgICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgPSB3aW5kb3dbdmVuZG9yc1t4XSArICdSZXF1ZXN0QW5pbWF0aW9uRnJhbWUnXTtcclxuICAgICAgd2luZG93LmNhbmNlbEFuaW1hdGlvbkZyYW1lID0gd2luZG93W3ZlbmRvcnNbeF0gKyAnQ2FuY2VsQW5pbWF0aW9uRnJhbWUnXSB8fCB3aW5kb3dbdmVuZG9yc1t4XSArICdDYW5jZWxSZXF1ZXN0QW5pbWF0aW9uRnJhbWUnXTtcclxuICB9XHJcblxyXG4gIGlmICghd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSkgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSA9IGZ1bmN0aW9uIChjYWxsYmFjaywgZWxlbWVudCkge1xyXG4gICAgICB2YXIgY3VyclRpbWUgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcclxuICAgICAgdmFyIHRpbWVUb0NhbGwgPSBNYXRoLm1heCgwLCAxNiAtIChjdXJyVGltZSAtIGxhc3RUaW1lKSk7XHJcbiAgICAgIHZhciBpZCA9IHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgIGNhbGxiYWNrKGN1cnJUaW1lICsgdGltZVRvQ2FsbCk7XHJcbiAgICAgIH0sXHJcbiAgICAgIHRpbWVUb0NhbGwpO1xyXG4gICAgICBsYXN0VGltZSA9IGN1cnJUaW1lICsgdGltZVRvQ2FsbDtcclxuICAgICAgcmV0dXJuIGlkO1xyXG4gIH07XHJcblxyXG4gIGlmICghd2luZG93LmNhbmNlbEFuaW1hdGlvbkZyYW1lKSB3aW5kb3cuY2FuY2VsQW5pbWF0aW9uRnJhbWUgPSBmdW5jdGlvbiAoaWQpIHtcclxuICAgICAgY2xlYXJUaW1lb3V0KGlkKTtcclxuICB9O1xyXG59KCkpO1xyXG5cclxuXHJcblxyXG5mdW5jdGlvbiBzdWNjZXNzKGxvYykge1xyXG4gIGNvbnN0IHsgY29vcmRzIH0gPSBsb2M7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGVycm9yKGVycikge1xyXG4gIGNvbnNvbGUud2FybihgRVJST1IoJHtlcnIuY29kZX0pOiAke2Vyci5tZXNzYWdlfWApO1xyXG59XHJcblxyXG5jb25zdCBvcHRpb25zID0ge1xyXG4gIGVuYWJsZUhpZ2hBY2N1cmFjeTogdHJ1ZSxcclxuICB0aW1lb3V0OiA1MDAwLFxyXG4gIG1heGltdW1BZ2U6IDAsXHJcbn07XHJcblxyXG5mdW5jdGlvbiBjb25zb2xWYWx1ZSh2YWwpIHtcclxuICByZXR1cm4gdmFsO1xyXG59XHJcblxyXG5mdW5jdGlvbiBsb2NhdGlvbigpIHtcclxuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT5cclxuICAgIG5hdmlnYXRvci5nZW9sb2NhdGlvbi5nZXRDdXJyZW50UG9zaXRpb24ocmVzb2x2ZSwgZXJyb3IpXHJcbiAgKTtcclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gZ2V0TG9jYXRpb24oKSB7XHJcbiAgbGV0IHBvc2l0aW9uID0gYXdhaXQgbG9jYXRpb24oKTtcclxuICBwb3NpdGlvbiA9IGF3YWl0IHBvc2l0aW9uLmNvb3JkcztcclxuICBjb25zdCB7IGxhdGl0dWRlLCBsb25naXR1ZGUgfSA9IHBvc2l0aW9uO1xyXG5cclxuICBsZXQgd2VhdGhlckJ5UG9zaXRpb24gPSBhd2FpdCBmZXRjaChcclxuICAgIGBodHRwczovL2FwaS5vcGVud2VhdGhlcm1hcC5vcmcvZGF0YS8yLjUvd2VhdGhlcj9sYXQ9JHtsYXRpdHVkZX0mbG9uPSR7bG9uZ2l0dWRlfSZhcHBpZD0ke2FwaUtleX0mdW5pdHM9bWV0cmljJmxhbmc9cGxgXHJcbiAgKTtcclxuICBcclxuICBcclxuICBsZXQgd2VhdGhlckJ5SG91ciA9IGF3YWl0IGZldGNoKGBodHRwczovL2FwaS5vcGVud2VhdGhlcm1hcC5vcmcvZGF0YS8yLjUvb25lY2FsbD9sYXQ9JHtsYXRpdHVkZX0mbG9uPSR7bG9uZ2l0dWRlfSZcclxuICBleGNsdWRlPWhvdXJseSZhcHBpZD0ke2FwaUtleX0mdW5pdHM9bWV0cmljYCk7XHJcbiAgd2VhdGhlckJ5UG9zaXRpb24gPSBhd2FpdCB3ZWF0aGVyQnlQb3NpdGlvbi5qc29uKCk7XHJcblxyXG4gIHdlYXRoZXJCeUhvdXIgPSBhd2FpdCB3ZWF0aGVyQnlIb3VyLmpzb24oKTtcclxuICB3ZWF0aGVyQnlIb3VyID0gd2VhdGhlckJ5SG91ci5ob3VybHk7XHJcblxyXG4gIGxldCBuZXh0U2V2ZW5EYXlzID0gYXdhaXQgZmV0Y2goYGh0dHBzOi8vYXBpLm9wZW53ZWF0aGVybWFwLm9yZy9kYXRhLzIuNS9vbmVjYWxsP2xhdD0ke2xhdGl0dWRlfSZsb249JHtsb25naXR1ZGV9JlxyXG4gIGV4Y2x1ZGU9ZGFpbHkmYXBwaWQ9JHthcGlLZXl9JnVuaXRzPW1ldHJpY2ApXHJcbiAgbmV4dFNldmVuRGF5cyA9IGF3YWl0IG5leHRTZXZlbkRheXMuanNvbigpO1xyXG4gIG5leHRTZXZlbkRheXMgPSBuZXh0U2V2ZW5EYXlzLmRhaWx5O1xyXG4gIGNvbnNvbGUubG9nKHdlYXRoZXJCeVBvc2l0aW9uKVxyXG4gIGNvbnN0IHdlYXRoZXJEYXRhID0gbmV3IFdlYXRoZXJJbmZvcm1hdGlvbih3ZWF0aGVyQnlQb3NpdGlvbik7XHJcbiAgd2VhdGhlckRhdGEuc2V0V2VhdGhlckluZm9ybWF0aW9uKCk7XHJcbiAgY29uc3QgY2hhcnQgPSBuZXcgQ2hhcnQod2VhdGhlckJ5SG91cik7XHJcbiAgY2hhcnQuY2hhcnQoKTtcclxuICBjb25zdCBmb3JlY2FzdEZvcldlZWsgPSBuZXcgV2Vla0ZvcmVjYXN0KG5leHRTZXZlbkRheXMpO1xyXG4gIGZvcmVjYXN0Rm9yV2Vlay5hZGRXZWF0aGVyRm9yZWNhc3QoKTtcclxuICBcclxufVxyXG5cclxuXHJcblxyXG5cclxuXHJcbmNsYXNzIFdlYXRoZXJJbmZvcm1hdGlvbiB7XHJcbiAgY29uc3RydWN0b3Iod2VhdGhlckluZm8pIHtcclxuICAgIHRoaXMubG9jYXRpb24gPSB3ZWF0aGVySW5mby5uYW1lLFxyXG4gICAgdGhpcy5jb3VudHJ5ID0gd2VhdGhlckluZm8uc3lzLmNvdW50cnlcclxuICAgIHRoaXMuZGF0ZSA9IG5ldyBEYXRlKCksXHJcbiAgICB0aGlzLnRlbXAgPSB3ZWF0aGVySW5mby5tYWluLnRlbXAsXHJcbiAgICB0aGlzLmljb25OYW1lID0gd2VhdGhlckluZm8ud2VhdGhlclswXS5tYWluLFxyXG4gICAgdGhpcy5wcmVzc3VyZSA9IHdlYXRoZXJJbmZvLm1haW4ucHJlc3N1cmUsXHJcbiAgICB0aGlzLmh1bWlkaXR5ID0gd2VhdGhlckluZm8ubWFpbi5odW1pZGl0eSxcclxuICAgIHRoaXMud2luZFNwcGVkID0gd2VhdGhlckluZm8ud2luZC5zcGVlZFxyXG4gIH1cclxuXHJcbiAgc2V0TG9jYXRpb24oKSB7XHJcbiAgICBjb25zdCBsb2NhdGlvbklEID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImhlYWRUZXh0X19sb2NhdGlvbi0tanNcIilbMF07XHJcbiAgICBsb2NhdGlvbklELmlubmVySFRNTCA9IGBpbiAke3RoaXMubG9jYXRpb259LCAke3RoaXMuY291bnRyeX1gO1xyXG4gIH1cclxuICBzZXREYXRlKCkge1xyXG4gICAgY29uc3QgZGF0ZUlEID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImhlYWRUZXh0X19kYXRlLS1qc1wiKVswXTtcclxuICAgIGRhdGVJRC5pbm5lckhUTUwgPSBgVG9kYXkgJHt0aGlzLmRhdGUuZ2V0RGF0ZSgpfXRoLCAke3RoaXMuZGF0ZS50b0xvY2FsZVN0cmluZygnZW4tRU4nLCB7bW9udGg6ICdsb25nJ30pfWBcclxuICB9XHJcbiAgXHJcbiAgc2V0VGVtcCgpIHtcclxuICAgIGNvbnN0IHRlbXBJRCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJoZWFkVGV4dC0tZGVncmVlcy1qc1wiKVswXTtcclxuICAgIHRlbXBJRC5pbm5lckhUTUwgPSBgJHt0aGlzLnRlbXAudG9GaXhlZCgxKX0gwrBDYDtcclxuICB9XHJcblxyXG4gIHNldFByZXNzdXJlKCkge1xyXG4gICAgY29uc3QgcHJlc3N1cmVJRCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJ3ZWF0aGVyVG9kYXlfX3ByZXNzdXJlLS1qc1wiKVswXTtcclxuICAgIHByZXNzdXJlSUQuaW5uZXJIVE1MID0gYCR7dGhpcy5wcmVzc3VyZX0gaFBhYDtcclxuICB9XHJcblxyXG4gIHNldEh1bWlkaXR5KCkge1xyXG4gICAgY29uc3QgaHVtaWRpdHlJRCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJ3ZWF0aGVyVG9kYXlfX2h1bWlkaXR5LS1qc1wiKVswXTtcclxuICAgIGh1bWlkaXR5SUQuaW5uZXJIVE1MID0gYCR7dGhpcy5odW1pZGl0eX0gJWA7XHJcbiAgfVxyXG5cclxuICBzZXRXaW5kU3BlZWQoKSB7XHJcbiAgICBjb25zdCB3aW5kU3BlZWRJRCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJ3ZWF0aGVyVG9kYXlfX3dpbmRTcGVlZC0tanNcIilbMF07XHJcbiAgICB3aW5kU3BlZWRJRC5pbm5lckhUTUwgPSBgJHt0aGlzLndpbmRTcHBlZH0gbS9zYDtcclxuICB9XHJcblxyXG4gIHNldFdlYXRoZXJJbmZvcm1hdGlvbigpIHtcclxuICAgIHRoaXMuc2V0TG9jYXRpb24oKTtcclxuICAgIHRoaXMuc2V0RGF0ZSgpO1xyXG4gICAgdGhpcy5zZXRUZW1wKCk7XHJcbiAgICB0aGlzLnNldFByZXNzdXJlKCk7XHJcbiAgICB0aGlzLnNldEh1bWlkaXR5KCk7XHJcbiAgICB0aGlzLnNldFdpbmRTcGVlZCgpO1xyXG4gIH1cclxuXHJcbiAgd2VhdGhlckljb24od2VhdGhlcikge1xyXG4gICAgbGV0IGN1cnJlbnREYXRlID0gbmV3IERhdGUoKTtcclxuICAgIGN1cnJlbnREYXRlID0gY3VycmVudERhdGUuZ2V0SG91cnMoKTtcclxuICAgIHN3aXRjaCh3ZWF0aGVyKSB7XHJcbiAgICAgIGNhc2UgJ3RodW5kZXJzdG9ybSc6XHJcbiAgICAgICAgcmV0dXJuICdzdG9ybS5zdmcnO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlICdEcml6emxlJzpcclxuICAgICAgICByZXR1cm4gJ0RyaXp6bGUuc3ZnJztcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAnUmFpbic6XHJcbiAgICAgICAgcmV0dXJuICdSYWluLnN2Zyc7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgJ1Nub3cnOlxyXG4gICAgICAgIHJldHVybiAnU25vd2ZsYWtlLnN2Zyc7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgJ0F0bW9zcGhlcmUnOlxyXG4gICAgICAgIHJldHVybiAnZm9nLnN2Zyc7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgJ0NsZWFyJzpcclxuICAgICAgICBpZihjdXJyZW50RGF0ZSA8PSAyMCkge1xyXG4gICAgICAgICAgcmV0dXJuICdzdW4uc3ZnJztcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgIHJldHVybiAnbW9vbi5zdmcnO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgICBjYXNlICdDbG91ZHMnOlxyXG4gICAgICAgIHJldHVybiAnQ2xvdWRzLnN2ZydcclxuICAgICAgICBicmVhaztcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNldEltYWdlKCkge1xyXG4gICAgY29uc3QgaW1hZ2VJRCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJ3ZWF0aGVySW1hZ2UtLWpzXCIpWzBdO1xyXG4gICAgY29uc3Qgd2VhdGhlck5hbWUgPSB0aGlzLndlYXRoZXJJY29uKHRoaXMuaWNvbk5hbWUpO1xyXG4gICAgaW1hZ2VJRC5zcmMgPSBgYXNzZXRzL2ltZy8ke3dlYXRoZXJOYW1lfWA7XHJcbiAgfVxyXG4gIHJvdW5kVGVtcCh0ZW1wKSB7XHJcbiAgICByZXR1cm4gTWF0aC5yb3VuZCgodGVtcCAqIDEwMCkvMTAwKTtcclxuICB9XHJcbn1cclxuY2xhc3MgQ2hhcnQge1xyXG4gIGNvbnN0cnVjdG9yKHdlYXRoZXJEYXRhKSB7XHJcbiAgICB0aGlzLndlYXRoZXJCeUhvdXIgPSB3ZWF0aGVyRGF0YTtcclxuICAgIHRoaXMuY29uZGl0aW9uID0gZmFsc2U7XHJcbiAgICB0aGlzLnN0YXRlID0ge307XHJcbiAgICB0aGlzLnRvb2x0aXAgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiY2hhcnRUZW1wX190b29sdGlwXCIpWzBdO1xyXG4gICAgdGhpcy5jYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNoYXJ0VGVtcF9fY2FudmFzXCIpO1xyXG4gICAgdGhpcy5jdHggPSB0aGlzLmNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XHJcbiAgfVxyXG5cclxuICBjYW52YXNEaW1lbnNpb25zKCkge1xyXG4gICAgdGhpcy5jYW52YXMud2lkdGggPSA2NjA7XHJcbiAgICB0aGlzLmNhbnZhcy5oZWlnaHQgPSAzMDk7XHJcbiAgfVxyXG5cclxuICBibG9ja3MoY291bnQpIHtcclxuICAgIHJldHVybiBjb3VudCAqIDQwO1xyXG4gIH1cclxuXHJcbiAgZHJhd0dyaWQoKSB7XHJcbiAgICBsZXQgZ3JpZFggPSA0MDtcclxuICAgIGxldCBncmlkWSA9IDQwO1xyXG4gICAgY29uc3QgY2VsbFNpemUgPSA0MDtcclxuICAgIHRoaXMuY3R4LmJlZ2luUGF0aCgpO1xyXG4gICAgdGhpcy5jdHguc3Ryb2tlU3R5bGUgPSBcImxpZ2h0Z3JleVwiO1xyXG4gIFxyXG4gICAgd2hpbGUgKGdyaWRYIDw9IHRoaXMuY2FudmFzLndpZHRoIC0gMjApIHtcclxuICAgICAgdGhpcy5jdHgubW92ZVRvKGdyaWRYLCAyMCk7XHJcbiAgICAgIHRoaXMuY3R4LmxpbmVUbyhncmlkWCwgdGhpcy5jYW52YXMuaGVpZ2h0IC0gMjApO1xyXG4gICAgICBncmlkWCArPSBjZWxsU2l6ZTtcclxuICAgIH1cclxuICAgIHdoaWxlIChncmlkWSA8PSB0aGlzLmNhbnZhcy5oZWlnaHQgLSAyMCkge1xyXG4gICAgICB0aGlzLmN0eC5tb3ZlVG8oMjAsIGdyaWRZKTtcclxuICAgICAgdGhpcy5jdHgubGluZVRvKHRoaXMuY2FudmFzLndpZHRoIC0gMTAsIGdyaWRZKTtcclxuICAgICAgZ3JpZFkgKz0gY2VsbFNpemU7XHJcbiAgICB9XHJcbiAgICB0aGlzLmN0eC5zdHJva2UoKTtcclxuICB9XHJcblxyXG4gIGFzeW5jIGRyYXdBeGlzKGhvdXJzKSB7XHJcbiAgICB0aGlzLmN0eC5iZWdpblBhdGgoKTtcclxuICAgIHRoaXMuY3R4LnN0cm9rZVN0eWxlID0gXCJibGFja1wiO1xyXG4gICAgdGhpcy5jdHgubW92ZVRvKHRoaXMuYmxvY2tzKDEpLCB0aGlzLmJsb2NrcygxIC8gMikpO1xyXG4gICAgdGhpcy5jdHgubGluZVRvKHRoaXMuYmxvY2tzKDEpLCB0aGlzLmJsb2Nrcyg3KSk7XHJcbiAgICB0aGlzLmN0eC5saW5lVG8odGhpcy5ibG9ja3MoMTYpLCB0aGlzLmJsb2Nrcyg3KSk7XHJcbiAgXHJcbiAgICB0aGlzLmN0eC5tb3ZlVG8odGhpcy5ibG9ja3MoMSksIHRoaXMuYmxvY2tzKDcpKTtcclxuICAgIGxldCB0ZXh0ID0gMDtcclxuICAgIGxldCB0ZXh0WSA9IHRoaXMuYmxvY2tzKDcpO1xyXG4gICAgZm9yIChsZXQgaSA9IDE7IGkgPD0gNzsgaSsrKSB7XHJcbiAgICAgIHRoaXMuY3R4LnN0cm9rZVRleHQodGV4dCwgdGhpcy5ibG9ja3MoMSAvIDIpLCB0ZXh0WSk7XHJcbiAgICAgIHRleHRZIC09IDQwO1xyXG4gICAgICB0ZXh0ICs9IDU7XHJcbiAgICB9XHJcbiAgXHJcbiAgICB0aGlzLmN0eC5tb3ZlVG8odGhpcy5ibG9ja3MoMiksIHRoaXMuYmxvY2tzKDcpKTtcclxuICAgIGxldCB0ZXh0WCA9IHRoaXMuYmxvY2tzKDEuOSk7XHJcbiAgXHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8PSAxNTsgaSsrKSB7XHJcbiAgICAgIHRoaXMuY3R4LnN0cm9rZVRleHQoaG91cnNbaV0sIHRleHRYLCB0aGlzLmJsb2Nrcyg3LjUpKTtcclxuICAgICAgdGV4dFggKz0gNDA7XHJcbiAgICB9XHJcbiAgICB0aGlzLmN0eC5zdHJva2UoKTtcclxuICB9XHJcbiAgdGltZXN0YW1wVG9UaW1lKHN0YW1wKSB7XHJcbiAgICBsZXQgZGF0ZSA9IG5ldyBEYXRlKHN0YW1wICogMTAwMCk7XHJcbiAgICByZXR1cm4gZGF0ZS5nZXRIb3VycygpO1xyXG4gIH1cclxuICBcclxuICBtYXBBbmRGaWx0ZXIodGVtcEFycmF5KSB7XHJcbiAgICB0ZW1wQXJyYXkgPSB0ZW1wQXJyYXkubWFwKChlbCkgPT4gdGhpcy50aW1lc3RhbXBUb1RpbWUoZWwpKTtcclxuICAgIHRlbXBBcnJheSA9IHRlbXBBcnJheS5maWx0ZXIoKGVsKSA9PiBlbCAlIDIgPT0gMCk7XHJcbiAgICByZXR1cm4gdGVtcEFycmF5O1xyXG4gIH1cclxuICBcclxuICB0ZW1wZXJhdHVyZVRvQ2hhcnRDb29yZHModGVtcCl7XHJcbiAgICBsZXQgdGVtcGVyYXR1cmUgPSB0ZW1wLm1hcCgoZWwpID0+IGVsIC8gNSk7XHJcbiAgICB0ZW1wZXJhdHVyZSA9IHRlbXBlcmF0dXJlLnNsaWNlKDAsMTUpO1xyXG4gICAgcmV0dXJuIHRlbXBlcmF0dXJlO1xyXG4gIH1cclxuICBcclxuICBnZXRIb3Vyc0Nvb3JkcygpIHtcclxuICAgIGxldCBob3VyT2ZUZW1wID0gWy4uLkFycmF5KDE3KS5rZXlzKCldXHJcbiAgICBob3VyT2ZUZW1wID0gaG91ck9mVGVtcC5zbGljZSgyLCAxNyk7XHJcbiAgXHJcbiAgICByZXR1cm4gaG91ck9mVGVtcDtcclxuICB9XHJcbiAgXHJcbiAgZHJhd0NoYXJ0KHRlbXBlcmF0dXJlKSB7XHJcbiAgICBjb25zdCB0ZW1wSG91cnMgPSB0aGlzLmdldEhvdXJzQ29vcmRzKCk7XHJcbiAgICBsZXQgaSA9IDE7XHJcbiAgICBjb25zdCBjb250ZXh0ID0gdGhpcy5jdHhcclxuICAgIGNvbnN0IGJsb2NrID0gdGhpcy5ibG9ja3MuYmluZCh0aGlzKTtcclxuICAgIGZ1bmN0aW9uIGFuaW1hdGlvbigpIHtcclxuICAgICAgaWYgKGkgPD0gdGVtcGVyYXR1cmUubGVuZ3RoKSB7XHJcbiAgICAgICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShhbmltYXRpb24pO1xyXG4gICAgICB9XHJcbiAgICAgIGNvbnRleHQuc3Ryb2tlU3R5bGUgPSBcIiNGRkU3NEFcIjtcclxuICAgICAgY29udGV4dC5saW5lV2lkdGggPSAzO1xyXG4gICAgICBjb250ZXh0LmJlZ2luUGF0aCgpO1xyXG4gICAgICBjb250ZXh0Lm1vdmVUbyhibG9jayh0ZW1wSG91cnNbaS0xXSksIGF4aXNYcG9zaXRpb24gLSBibG9jayh0ZW1wZXJhdHVyZVtpLTFdKSk7XHJcbiAgICAgIGNvbnRleHQuYXJjKGJsb2NrKHRlbXBIb3Vyc1tpLTFdKSwgYXhpc1hwb3NpdGlvbiAtIGJsb2NrKHRlbXBlcmF0dXJlW2ktMV0pLCAzLCAwLCBNYXRoLlBJICogMiwgdHJ1ZSk7XHJcbiAgICAgIGNvbnRleHQubGluZVRvKGJsb2NrKHRlbXBIb3Vyc1tpXSksIGF4aXNYcG9zaXRpb24gLSBibG9jayh0ZW1wZXJhdHVyZVtpXSkpO1xyXG4gICAgICBjb250ZXh0LnN0cm9rZSgpO1xyXG4gICAgICBpKys7XHJcbiAgICB9XHJcbiAgICBhbmltYXRpb24oKTtcclxuICB9XHJcbiAgXHJcbiAgYXN5bmMgd2FpdEZvckdyaWQobXMpIHtcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShyID0+IHNldFRpbWVvdXQociwgbXMpKTtcclxuICB9XHJcbiAgXHJcbiAgZ2V0TW91c2VQb3NpdGlvbihldnQpIHtcclxuICAgIGxldCByZWN0ID0gdGhpcy5jYW52YXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICB4OiBldnQuY2xpZW50WCAtIHJlY3QubGVmdCxcclxuICAgICAgeTogZXZ0LmNsaWVudFkgLSByZWN0LnRvcFxyXG4gICAgfTtcclxuICB9XHJcbiAgXHJcbiAgZmlsdGVyVGVtcGVyYXR1cmUodGVtcGVyYXR1cmUpIHtcclxuICAgIGNvbnN0IHRlbXAgPSB0ZW1wZXJhdHVyZVxyXG4gICAgICAubWFwKChvYmopID0+IG9iai50ZW1wKVxyXG4gICAgICAuZmlsdGVyKChlbCwgaW5kZXgpID0+IGluZGV4ICUgMiA9PSAwKTtcclxuICBcclxuICAgIHJldHVybiB0ZW1wO1xyXG4gIH1cclxuICBcclxuICB0ZW1wZXJhdHVyZVRvUGl4ZWwodGVtcCl7XHJcbiAgICB0ZW1wID0gdGVtcC5tYXAoZWwgPT4gYXhpc1hwb3NpdGlvbiAtIHRoaXMuYmxvY2tzKGVsKSk7XHJcbiAgICByZXR1cm4gdGVtcDtcclxuICB9XHJcbiAgXHJcbiAgaG91cnNUb1BpeGVsKGhvdXJzKSB7XHJcbiAgICBjb25zdCBob3VycnMgPSBob3Vycy5tYXAoZWwgPT4gdGhpcy5ibG9ja3MoZWwpKTtcclxuICAgIHJldHVybiBob3VycnM7XHJcbiAgfVxyXG4gIFxyXG4gIGNyZWF0ZVRlbXBPYmooaG91ciwgdGVtcCwgaG91ck9mVGVtcCwgdGVtcEluSG91cil7XHJcbiAgICBjb25zdCB0ZW1wUG9pbnRDb29yZHMgPSBbXTtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGVtcC5sZW5ndGg7IGkrKyl7XHJcbiAgICAgIHRlbXBQb2ludENvb3Jkcy5wdXNoKHtcclxuICAgICAgICB4OiBob3VyW2ldLFxyXG4gICAgICAgIHk6IHRlbXBbaV0sXHJcbiAgICAgICAgeG1pbjogaG91cltpXSAtIDMsXHJcbiAgICAgICAgeG1heDogaG91cltpXSArIDMsXHJcbiAgICAgICAgeW1pbjogdGVtcFtpXSAtIDMsXHJcbiAgICAgICAgeW1heDogdGVtcFtpXSArIDMsXHJcbiAgICAgICAgaG91clRlbXA6IHtcclxuICAgICAgICAgIGhvdXI6IGhvdXJPZlRlbXBbaV0sXHJcbiAgICAgICAgICB0ZW1wOiB0ZW1wSW5Ib3VyW2ldXHJcbiAgICAgICAgfSxcclxuICBcclxuICAgICAgfSlcclxuICAgIH1cclxuICAgIHJldHVybiB0ZW1wUG9pbnRDb29yZHM7XHJcbiAgfVxyXG4gIFxyXG4gIGRyYXdQb2ludChjb29yZHMgPSB7fSwgcmFkaXVzLCBjb2xvciA9ICd3aGl0ZScpIHtcclxuICAgIGNvbnN0IG1vdXNlQ29vcmRpbmF0ZSA9IGNvb3JkcztcclxuICAgIHRoaXMuY3R4LnN0cm9rZVN0eWxlID0gY29sb3I7XHJcbiAgICB0aGlzLmN0eC5iZWdpblBhdGgoKTtcclxuICAgIHRoaXMuY3R4Lm1vdmVUbyhtb3VzZUNvb3JkaW5hdGUueCwgbW91c2VDb29yZGluYXRlLnkpO1xyXG4gICAgdGhpcy5jdHguYXJjKG1vdXNlQ29vcmRpbmF0ZS54LCBtb3VzZUNvb3JkaW5hdGUueSwgcmFkaXVzLCAwLCBNYXRoLlBJICogMiwgdHJ1ZSk7XHJcbiAgICB0aGlzLmN0eC5maWxsU3R5bGUgPSBjb2xvcjtcclxuICAgIHRoaXMuY3R4LmZpbGwoKTtcclxuICAgIHRoaXMuY3R4LnN0cm9rZSgpO1xyXG4gIH1cclxuICBcclxuXHJcbiAgYWRkUG9wVXAodGVtcFBvaW50KSB7XHJcbiAgICB0aGlzLmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCAoZSkgPT4ge1xyXG4gICAgICBjb25zdCBtb3VzZUNvb3JkcyA9IHRoaXMuZ2V0TW91c2VQb3NpdGlvbihlKTtcclxuICAgICAgbGV0IGJvb29scyA9IHRlbXBQb2ludC5maWx0ZXIoZWwgPT4ge1xyXG4gICAgICAgIGNvbnN0IGEgPSBlbC54bWluIDw9IG1vdXNlQ29vcmRzLng7XHJcbiAgICAgICAgY29uc3QgYiA9IG1vdXNlQ29vcmRzLnggPD0gZWwueG1heDtcclxuICAgICAgICBjb25zdCBjID0gZWwueW1pbiA8PSBtb3VzZUNvb3Jkcy55O1xyXG4gICAgICAgIGNvbnN0IGQgPSBtb3VzZUNvb3Jkcy55IDw9IGVsLnltYXg7XHJcbiAgICAgICAgcmV0dXJuIChhICYmIGIgJiYgYyAmJiBkKX0pXHJcbiAgICAgIFxyXG4gICAgICBpZihib29vbHMubGVuZ3RoKSB7XHJcbiAgICAgICAgdGhpcy5kcmF3UG9pbnQoYm9vb2xzWzBdLCAxKTtcclxuICAgICAgICB0aGlzLnN0YXRlID0gey4uLmJvb29sc1swXX07XHJcbiAgICAgICAgdGhpcy5jb25kaXRpb24gPSB0cnVlO1xyXG4gICAgICAgIGlmICh0aGlzLmNhbnZhcy53aWR0aCAtICh0aGlzLnN0YXRlLnggKyA1KSA8PSA4MCl7XHJcbiAgICAgICAgICB0aGlzLnRvb2x0aXAuc3R5bGUubGVmdCA9IGAke3RoaXMuc3RhdGUueCAtIDg1fXB4YFxyXG4gICAgICAgICAgdGhpcy50b29sdGlwLnN0eWxlLnRvcCA9IGAke3RoaXMuc3RhdGUueSAtIDM1fXB4YDtcclxuICAgICAgICAgIFxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgIHRoaXMudG9vbHRpcC5zdHlsZS5sZWZ0ID0gYCR7dGhpcy5zdGF0ZS54ICsgNX1weGA7XHJcbiAgICAgICAgICB0aGlzLnRvb2x0aXAuc3R5bGUudG9wID0gYCR7dGhpcy5zdGF0ZS55IC0gMzV9cHhgO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnRvb2x0aXAuc3R5bGUuZGlzcGxheSA9ICdmbGV4JztcclxuICAgICAgICB0aGlzLnRvb2x0aXAuaW5uZXJIVE1MID0gYFRpbWU6ICR7dGhpcy5zdGF0ZS5ob3VyVGVtcC5ob3VyfTowMCwgVGVtcDogJHt0aGlzLnN0YXRlLmhvdXJUZW1wLnRlbXB9wrBDYDtcclxuICAgICAgfSBcclxuICAgICAgZWxzZSBpZighYm9vb2xzLmxlbmd0aCkge1xyXG4gICAgICAgIHRoaXMuZHJhd1BvaW50KHRoaXMuc3RhdGUsIDMsIFwiI0ZGRTc0QVwiKTtcclxuICAgICAgICB0aGlzLmNvbmRpdGlvbiA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuc3RhdGUgPSB7fTtcclxuICAgICAgICB0aGlzLnRvb2x0aXAuc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxuICAgICAgfSBcclxuICAgIH0pXHJcbiAgfVxyXG4gIFxyXG4gIGFzeW5jIGNoYXJ0KCkge1xyXG4gICAgY29uc3QgaG91ck9mV2VhdGhlciA9IHRoaXMubWFwQW5kRmlsdGVyKHRoaXMud2VhdGhlckJ5SG91ci5tYXAoKG9iaikgPT4gb2JqLmR0KSk7XHJcbiAgICBsZXQgdGVtcGVyYXR1cmUgPSB0aGlzLmZpbHRlclRlbXBlcmF0dXJlKHRoaXMud2VhdGhlckJ5SG91cik7XHJcbiAgICBjb25zdCB0ZW1wZXJhdHVyZUNvb3JkcyA9IHRoaXMudGVtcGVyYXR1cmVUb0NoYXJ0Q29vcmRzKHRlbXBlcmF0dXJlKTtcclxuICAgIFxyXG4gICAgY29uc3QgdGVtcFBpeGVscyA9IHRoaXMudGVtcGVyYXR1cmVUb1BpeGVsKHRlbXBlcmF0dXJlQ29vcmRzKTtcclxuICAgIGNvbnN0IGhvdXJzUGl4ZWxzID0gdGhpcy5ob3Vyc1RvUGl4ZWwodGhpcy5nZXRIb3Vyc0Nvb3JkcygpKTtcclxuICAgIFxyXG4gICAgY29uc3QgdGVtcFBvaW50cyA9IHRoaXMuY3JlYXRlVGVtcE9iaihob3Vyc1BpeGVscywgdGVtcFBpeGVscywgaG91ck9mV2VhdGhlciwgdGVtcGVyYXR1cmUpO1xyXG4gIFxyXG4gICAgdGhpcy5jYW52YXNEaW1lbnNpb25zKCk7XHJcbiAgICB0aGlzLmRyYXdHcmlkKCk7XHJcbiAgICB0aGlzLmRyYXdBeGlzKGhvdXJPZldlYXRoZXIpO1xyXG4gICAgYXdhaXQgdGhpcy53YWl0Rm9yR3JpZCg1MDApO1xyXG4gICAgdGhpcy5kcmF3Q2hhcnQodGVtcGVyYXR1cmVDb29yZHMpXHJcbiAgICB0aGlzLmFkZFBvcFVwKHRlbXBQb2ludHMpO1xyXG4gIH1cclxuXHJcbn1cclxuXHJcbmNsYXNzIFdlZWtGb3JlY2FzdCB7XHJcbiAgY29uc3RydWN0b3Iod2Vla0ZvcmVjYXN0RGF0YSkge1xyXG4gICAgdGhpcy53ZWVrRGF0YSA9IHdlZWtGb3JlY2FzdERhdGE7XHJcbiAgICB0aGlzLndlYXRoZXJGb3JlY2FzdENvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJ3ZWF0aGVyRm9yZWNhc3QtLWpzXCIpO1xyXG4gICAgdGhpcy53ZWF0aGVyRm9yZWNhc3RDb250YWluZXIgPSB0aGlzLndlYXRoZXJGb3JlY2FzdENvbnRhaW5lclswXTtcclxuICB9XHJcblxyXG4gIHNsaWNlV2Vla0RhdGFBcnJheSgpe1xyXG4gICAgdGhpcy53ZWVrRGF0YSA9IHRoaXMud2Vla0RhdGEuc2xpY2UoMSw4KTtcclxuICAgIGNvbnNvbGUubG9nKHRoaXMud2Vla0RhdGEpXHJcbiAgfVxyXG4gIGdldFRpbWVzdGFtcFRvVGltZSh0aW1lc3RhbXApIHtcclxuICAgIGNvbnN0IHRpbWUgPSBuZXcgRGF0ZSh0aW1lc3RhbXAgKiAxMDAwKTtcclxuICAgIHJldHVybiB0aW1lLmdldERheSgpO1xyXG4gIH1cclxuICBnZXROYW1lT2ZXZWVrKG51bWJlcikge1xyXG4gICAgc3dpdGNoIChudW1iZXIpIHtcclxuICAgICAgY2FzZSAwOlxyXG4gICAgICAgIHJldHVybiBcIlN1blwiO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIDE6XHJcbiAgICAgICAgcmV0dXJuIFwiTW9uXCI7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgMjpcclxuICAgICAgICByZXR1cm4gXCJUdWVcIjtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAzOlxyXG4gICAgICAgIHJldHVybiBcIldlZFwiO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIDQ6XHJcbiAgICAgICAgcmV0dXJuIFwiVGh1clwiO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIDU6IFxyXG4gICAgICAgIHJldHVybiBcIkZyaVwiO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIDY6XHJcbiAgICAgICAgcmV0dXJuIFwiU2F0XCI7XHJcbiAgICAgICAgYnJlYWtcclxuICAgIH1cclxuICB9XHJcbiAgZ2V0V2VhdGhlclBhcmFtZXRlcnMoKXtcclxuICAgIHRoaXMud2Vla0RhdGEgPSB0aGlzLndlZWtEYXRhLm1hcChlbCA9PiB7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgZGF5OiB0aGlzLmdldE5hbWVPZldlZWsodGhpcy5nZXRUaW1lc3RhbXBUb1RpbWUoZWwuZHQpKSwgXHJcbiAgICAgICAgdGVtcDogZWwudGVtcC5kYXksXHJcbiAgICAgICAgd2VhdGhlcjogZWwud2VhdGhlclswXS5tYWluXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgY29uc29sZS5sb2codGhpcy53ZWVrRGF0YSlcclxuICB9XHJcblxyXG4gIHB1dFdlYXRoZXJJbnRvU2VjdGlvbigpe1xyXG4gICAgdGhpcy53ZWF0aGVyRm9yZWNhc3RDb250YWluZXIuaW5uZXJIVE1MID0gJyc7XHJcbiAgICB0aGlzLndlZWtEYXRhLmZvckVhY2goZWwgPT4ge1xyXG4gICAgICB0aGlzLndlYXRoZXJGb3JlY2FzdENvbnRhaW5lci5pbm5lckhUTUwgKz0gYDxkaXYgY2xhc3M9XCJ3ZWF0aGVyRm9yZWNhc3RfX2RheSB3ZWF0aGVyRm9yZWNhc3RfX2RheS0tanNcIj48aW1nIGNsYXNzPVwid2VhdGhlckZvcmVjYXN0X19kYXlFbGVtZW50XCIgc3JjPScvYXNzZXRzL2ltZy93ZWF0aGVyaWNvbnMvJHt0aGlzLndlYXRoZXJJY29uKGVsLndlYXRoZXIpfScgYWx0PScnPjwvaW1nPjxkaXYgY2xhc3M9XCJ3ZWF0aGVyRm9yZWNhc3RfX2RheUVsZW1lbnRcIj48cD4ke2VsLmRheX08YnI+JHtlbC50ZW1wfTwvcD48L2Rpdj48L2Rpdj5gXHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgYWRkV2VhdGhlckZvcmVjYXN0KCkge1xyXG4gICAgdGhpcy5zbGljZVdlZWtEYXRhQXJyYXkoKTtcclxuICAgIHRoaXMuZ2V0V2VhdGhlclBhcmFtZXRlcnMoKTtcclxuICAgIHRoaXMucHV0V2VhdGhlckludG9TZWN0aW9uKCk7XHJcbiAgfVxyXG5cclxuICB3ZWF0aGVySWNvbih3ZWF0aGVyKSB7XHJcbiAgICBsZXQgY3VycmVudERhdGUgPSBuZXcgRGF0ZSgpO1xyXG4gICAgY3VycmVudERhdGUgPSBjdXJyZW50RGF0ZS5nZXRIb3VycygpO1xyXG4gICAgc3dpdGNoKHdlYXRoZXIpIHtcclxuICAgICAgY2FzZSAndGh1bmRlcnN0b3JtJzpcclxuICAgICAgICByZXR1cm4gJ3N0b3JtLnN2Zyc7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgJ0RyaXp6bGUnOlxyXG4gICAgICAgIHJldHVybiAnRHJpenpsZS5zdmcnO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlICdSYWluJzpcclxuICAgICAgICByZXR1cm4gJ1JhaW4uc3ZnJztcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAnU25vdyc6XHJcbiAgICAgICAgcmV0dXJuICdTbm93Zmxha2Uuc3ZnJztcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAnQXRtb3NwaGVyZSc6XHJcbiAgICAgICAgcmV0dXJuICdmb2cuc3ZnJztcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAnQ2xlYXInOlxyXG4gICAgICAgIGlmKGN1cnJlbnREYXRlIDw9IDIwKSB7XHJcbiAgICAgICAgICByZXR1cm4gJ3N1bi5zdmcnO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgcmV0dXJuICdtb29uLnN2Zyc7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICAgIGNhc2UgJ0Nsb3Vkcyc6XHJcbiAgICAgICAgcmV0dXJuICdDbG91ZHMuc3ZnJ1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbn1cclxuXHJcblxyXG5cclxuZ2V0TG9jYXRpb24oKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///0\n")}]);